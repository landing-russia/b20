---
import { getCollection, CollectionEntry } from "astro:content"
import Base from "@layouts/Base.astro"
import PostCard from "@components/PostCard.astro"
import Pagination from "@components/Pagination.astro"
import BlogTagsCloud from "@components/BlogTagsCloud.astro"
import { formatBlogPosts } from "@utils"

export async function getStaticPaths({ paginate }) {
  const allPosts = await getCollection("blog")
  const formattedPosts: CollectionEntry<"blog">[] = formatBlogPosts(allPosts)
  return paginate(formattedPosts, {
    pageSize: 10,
  })
}
const { page } = Astro.props
---

<Base title="Blog">
  <h1 class="h1">New Blog Posts</h1>
  <div class="post-container">
    {page.data.map((post) => <PostCard data={post.data} url={post.slug} />)}
  </div>
  <Pagination prevUrl={page.url.prev} nextUrl={page.url.next} />
  <BlogTagsCloud showCount={true} />
</Base>
